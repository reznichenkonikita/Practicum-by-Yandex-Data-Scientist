# Исследование объявлений о продаже квартир

## Цель и основные шаги работы

**Цель работы**: провести анализ объявлений о продаже квартир в Санкт-Петербурге и соседних населенных пунктов за несколько лет.

**Основные шаги работы**:
1. Ознакомиться с данными, содержащимися в файле data.csv;
1. Найти и обработать аномальные данные, выбросы, пропущенные значения. Понять возможные причины появления таких данных;
1. Найти и удалить дубликаты. Понять возможные причины появления дубликатов;
1. Изменить тип данных для столбцов;
1. Посчитать и добавить в таблицу:
    * цену квадратного метра;
    * день недели, месяц и год публикации объявления;
    * этаж квартиры (первый, последний, другой); 
    * соотношение жилой и общей площади;
    * отношение площади кухни к общей.
1. Провести исследовательский анализ, а именно:
    * Изучить следующие параметры: площадь, цена, число комнат, высота потолков. Построить гистограммы для каждого параметра.
    * Изучить время продажи квартиры. Построить гистограмму. Посчитать среднее и медиану. Описать сколько обычно занимает продажа. Определить, когда можно считать, что продажи прошли очень быстро, а когда необычно долго.
    * Убрать редкие и выбивающиеся значения. Описать, какие особенности обнаружил.
    * Какие факторы больше всего влияют на стоимость квартиры? Изучить, зависит ли цена от площади, числа комнат, удалённости от центра. Изучить зависимость цены от того, на каком этаже расположена квартира: первом, последнем или другом. Также изучить зависимость от даты размещения: дня недели, месяца и года.
    * Выберать 10 населённых пунктов с наибольшим числом объявлений. Посчитать среднюю цену квадратного метра в этих населённых пунктах. Выделить среди них населённые пункты с самой высокой и низкой стоимостью жилья. Эти данные можно будет найти по имени в столбце 'locality_name'.
    * Изучить предложения квартир: для каждой квартиры есть информация о расстоянии до центра. Выделите квартиры в Санкт-Петербурге ('locality_name'). Моя задача — выяснить, какая область входит в центр. Создать столбец с расстоянием до центра в километрах: округлите до целых значений. После этого посчитать среднюю цену для каждого километра. Построить график: он должен показывать, как цена зависит от удалённости от центра. Определите границу, где график сильно меняется — это и будет центральная зона.
    * Выделить сегмент квартир в центре. Проанализировать эту территорию и изучить следующие параметры: площадь, цена, число комнат, высота потолков. Также выделить факторы, которые влияют на стоимость квартиры (число комнат, этаж, удалённость от центра, дата размещения объявления). Сделать выводы. Отличаются ли они от общих выводов по всему городу?
1. Написать общий вывод к работе и высказать свои рекомендации.

## Описание данных
* расстояние до ближайшего аэропорта в метрах (м)
* число балконов
* высота потолков (м)
* расстояние до центра города (м)
* сколько дней было размещено объявление (от публикации до снятия)
* дата публикации
* этаж
* всего этажей в доме
* апартаменты (булев тип)
* площадь кухни в квадратных метрах (м²)
* цена на момент снятия с публикации
* жилая площадь в квадратных метрах(м²)
* название населённого пункта
* свободная планировка (булев тип)
* число парков в радиусе 3 км
* расстояние до ближайшего парка (м)
* число водоёмов в радиусе 3 км
* расстояние до ближайшего водоёма (м)
* число комнат
* квартира-студия (булев тип)
* площадь квартиры в квадратных метрах (м²)
* число фотографий квартиры в объявлении

## Использумый стек
Python, Pandas, numpy, matplotlib

## Вывод
Целью данного проекта было провести анализ объявлений о продаже квартир в Санкт-Петербурге и соседних населенных пунктов за несколько лет. В результате, проделанной работы, нам удалось следующее:

1. Изучить общую информацию о данных. 

    *Таблица содержит 23699 объявлений и 20 столбцов с информацией об объявлении, а именно:*
    * airports_nearest — расстояние до ближайшего аэропорта в метрах (м)
    * balcony — число балконов
    * ceiling_height — высота потолков (м)
    * cityCenters_nearest — расстояние до центра города (м)
    * days_exposition — сколько дней было размещено объявление (от публикации до снятия)
    * first_day_exposition — дата публикации
    * floor — этаж
    * floors_total — всего этажей в доме
    * is_apartment — апартаменты (булев тип)
    * kitchen_area — площадь кухни в квадратных метрах (м²)
    * last_price — цена на момент снятия с публикации
    * living_area — жилая площадь в квадратных метрах(м²)
    * locality_name — название населённого пункта
    * open_plan — свободная планировка (булев тип)
    * parks_around3000 — число парков в радиусе 3 км
    * parks_nearest — расстояние до ближайшего парка (м)
    * ponds_around3000 — число водоёмов в радиусе 3 км
    * ponds_nearest — расстояние до ближайшего водоёма (м)
    * rooms — число комнат
    * studio — квартира-студия (булев тип)
    * total_area — площадь квартиры в квадратных метрах (м²)
    * total_images — число фотографий квартиры в объявлении.
    
    
2. Провести предобработку данных. 
    
    *Удалили или восстановили информацию в следующих слолбцах:*
    - ***floors_total***. У 86 объявлений отсутствовала инфомарция об этажности здания и востановить данные не получилось, поэтому пришлось удалить эти объявления. Так как таких объявлений мало, то на результатах исследования это не сказалось.           
    **Рекомендации**: не позволять пользователю подать объявление пока не будет заполнен этот пункт;
    - ***ceiling_height***. У 9118 объявлений отсутствовала информация о высоте потолков в квартире. Это большая часть объявление, поэтому было принято решение восстановить эти данные путем замены в пропущенных объявлений на значение медианы в зависимости от количества этажей в доме;                   
    **Рекомендации**: не позволять пользователю подать объявление пока не будет заполнен этот пункт или искать эту инфомацию в других объявлениях по этому дому;
    - **living_area**. У 1870 объявлений отсутствовала информация о жилой площади в квартире. Было решено заменить пропущенные значения на значение медианы в зависимости от количества комнат в квартире.        
    **Рекомендации**: не позволять пользователю подать объявление пока не будет заполнен этот пункт или искать эту инфомацию в выписке из ЕГРН (если будет такая возможность);
    - ***kitchen_area***. У 2231 объявлений отсутствовала информация о площади кухни в квартире. Было решение сначала вычислить значение оставшейся площади в квартире, путем вычитания из общей площади квартиры жилой площади. Были выделены 4 категории оставшейся площади квартиры (очень маленькая, маленькая, средняя, большая), путем разбиения выборки на квартили. Пропущенные значения были заменены на значения медианы в зависимости от категории оставшейся площади квартиры.         
     **Рекомендации**: не позволять пользователю подать объявление пока не будет заполнен этот пункт или искать эту инфомацию в выписке из ЕГРН (если будет такая возможность);
    - ***is_apartment***. У 20838 объявлений отсутствовала информация о том, является ли квартира апартаментами. Предположительно, что не все люди понимают значения этого слова, поэтому и пропускали данный пункт. Те кто понимают значения этого слово явно указали является ли квартира апартаментами. Было решение все пропущенные значения заменить на False, так как если у человека квартира является апартаментами, он бы это явно знал и указал.    
     **Рекомендации**: не позволять пользователю подать объявление пока не будет заполнен этот пункт и писать примечание о значении слова апартаменты;
    - ***balcony***. У 11480 объявлений отсутствовала информация о количестве балконов в квартире. Было предположение, что если человек оставил это поле пустым, то у него отсутствуют балконы в квартиры, поэтому все пропущенные значения были заменены на 0.
     **Рекомендации**: не позволять пользователю подать объявление пока не будет заполнен этот пункт или если человек не заполнил этот пункт, то по умолчанию заполнять его 0;
    - ***parks_around3000*** и ***parks_nearest***. У 5508 отсутствовала инофмация о количестве парков в радиусе 3 км и у 15567 отсутствовала информация о расстоянии до ближайщего парка. Также у 10063 объявлений в графе количество парков было значение 0. Так как эти данные выгружает автоматичсекая система, основываясь на картографических данных, то было предположено, что у 5508 объявлений отсутствовала ифномарция о количестве парков в радиусе 3 км, так как картографиечские данные не располагали этой информацией. Было решение не заменять данные в этих столбцах, так как нет никакой зависимости количества ближайщих парков и расстония до них от других предоставленных параметров.                
     **Рекомендации**: улучшать картографические сервисы или позволять пользователю вводить эти данные, если в картографических данных эта информация отсутствует;
    - ***ponds_around3000*** и ***ponds_nearest***.  У 5508 отсутствовала инофмация о количестве водоемов в радиусе 3 км и у 14552 отсутствовала информация о расстоянии до ближайщего водоема. Также у 9044 объявлений в графе количество водоемов было значение 0. Так как эти данные выгружает автоматичсекая система, основываясь на картографических данных, то было предположено, что у 5508 объявлений отсутствовала ифномарция о количестве водоемов в радиусе 3 км, так как картографиечские данные не располагали этой информацией. Было решение не заменять данные в этих столбцах, так как нет никакой зависимости количества ближайщих водоемов и расстония до них от других предоставленных параметров.            
     **Рекомендации**: улучшать картографические сервисы или позволять пользователю вводить эти данные, если в картографических данных эта информация отсутствует;
    - ***airports_nearest*** и ***cityCenters_nearest***. У 5532 объявлений отсутствовала информация о расстоянии до ближайщего аэропорта и у 5509 отсутствовала информация о расстоянии до цента. Было предположение восстановить информацию о расстояниии до центра основываясь на расстоянии до аэропорта, но у всех объявлений, в которых отсутсвует информация о расстоянии до центра, также отсутствует информация о расстоянии до аэропорта. Затем была идея востановить данные основываясь на расстоянии до центра из других объявлений из этого же населенного пункта, но выяснилось, что у 261 из 284 населенных пунктов полностью отсутсвтует эта информация. Было принять решение не восстанавливать информацию в этих столбцах.             
     **Рекомендации**: улучшать картографические сервисы или позволять пользователю вводить эти данные, если в картографических данных эта информация отсутствует;
    - ***days_exposition***. У 3172 объявлений отсутствовала информация о количестве дней размещения объявления. Так как восстановить информацию не позволяет возможным, например, квартира еще не продана или продана уже давно, но не закрыли объявление, то принято решение не восстанавливать данные в этом столбце.          
     **Рекомендации**: если объявление висит уже долго, то отправлять напоминание пользователю на почту о скором закрытии объявления, например, каждый месяц;

   *Был проведен поиск дубликатов в таблице.* 
   
   Дубликатов в таблице не оказалось.
   
   *Заменили тип данных в следующих столбцах:*
   - ***last_price, floors_total, balcony, other_area***. Заменили тип данных на int. Причина: данные значения должны быть целочисленными;
   - ***first_day_exposition***. Заменили тип данных на datetime. Причина: дальнейшее удобство анализировать данные о дате подачи объявления (день недели, месяц, год).
   
   
3. Посчитать и добавть для дальнейшего анализа в таблицу следующие данные:
    - цену квадратного метра;
    - день недели, месяц и год публикации объявления;
    - этаж квартиры (первый, последний, другой);
    - соотношение жилой площади к общей площади;
    - соотношение площади кухни к общей площади.


4. Провести исследовательский анализ данных.

    ***Изучили следующие параметры: площадь, цена, число комнат, высота потолков.***
    
    ***Площадь***. Средняя площадь квартиры по всем объявлением составляет 60.38 кв.м, медиана же составляет 52 кв.м. Это объяняется аномальными данными, например, максимальное значение составляет 900 кв.м и в целом большим количеством выбросов по данному параметру, которые соствляют 1238. Выбросами считались значения, которые больше, чем 114.5 и меньше, чем 12.0. Гистограмма похожа на Пуассановсое распределение с пиком в районе 45 и плавным дальнешем уменьшением;         
    ***Цена***. Средняя цена квартиры по всем объявлением составляет 6.54 млн. руб, медиана же составляет 4.65 млн. руб. Это объяняется аномальными данными, например, максимальное значение составляет 763 млн. руб. и в целом большим количеством выбросов по данному параметру, которые соствляют 2049. Выбросами считались значения, которые больше, чем 11897500 и меньше, чем 12190. Гистограмма похожа на нормальное распределение с пиком в районе 4 млн;         
    ***Число комнат***. Среднее количество комнат в квартире по всем объявлением соствляет 2.07, медиана же составляет 2. Анамальных данных здесь немного, разве что 19 комнат в квартире. Количество выбросов 86. Выбросами считались значения, которые больше, чем 6 и меньше, чем 0. Гистограмма похожа на Пуассановсое распределение с пиком в районе 1-х и 2-х комнатных квартир и дальнейшем уменьшением;
    ***Высота потолков***. Среднее количество комнат в квартире по всем объявлением соствляет 2.73, медиана же составляет 2.65. В целом, аномальные данные присутствуют в столбце, например квартира с 100 метровыми поталками. Количество выбросов 1475. Выбросами считались значения, которые больше, чем 3.05 и меньше, чем 2.25. Гистограмма показывает, что пик находится на значениее 2.5 метра, также видно преобладание квартир с высотой потолков 2.7 метра.

    ***Изучили время продажи квартиры.***
    
    В среднем квартира продается за 180 дней, медиана же составляет 95 дней. Это объяняется аномальными данными, например, максимальное значение составляет 1580 дней, а минимальное 1 день и в целом большим количеством выбросов по данному параметру, которые соствляют 1663. Выбросами считаются значения, которые больше, чем 512.5 и меньше, чем 1.0. Гистограмма похожа на Пуассановсое распределение с пиком в районе 40 дней и плавным дальнешем уменьшением. Таким образом, если квартира продалась менее, чем за 95 дней, то будем считать, что это быстрая продажа. А если квартира продается более, чем 512 дней, то это продажа необычно долгая.
    
    ***Выделили хорошие данные***
     
     Фильтровали данные основываясь на выбросах:
     
     Для столбца ***total_area (общая площадь)*** выбросами считаются значения, которые больше, чем 114.5 и меньше, чем 12.0;               
    Для столбца ***last_price (цена)*** выбросами считаются значения, которые больше, чем 11897500.0 и меньше, чем 12190;                  
    Для столбца ***rooms (количество комнат)*** выбросами считаются значения, которые больше, чем 6.0 и меньше, чем 0;                  
    Для столбца ***ceiling_height (высота потолков)*** выбросами считаются значения, которые больше, чем 3.05 и меньше, чем 2.25.
    
    В результате процент хороших данных составил 86.16%.
    
    ***Выделили и проанализировали факторы, влияющие на стоимость квартиры*** 
    
    ***Заисимость цены от площади квартиры***. Построили диаграмму рассеяния. По диаграмме хорошо видна зависимость цены от площади квартиры, что также подтвержается посчитанным коэффициентом корреляции, который составил 0.68. Большинство квартир площадью 30-50 кв.м. и ценой 2-5 млн.руб;             
    ***Заисимость цены от удаленности от центра***. Построили диаграмму рассеяния. По диаграмме видно, что бОльшая часть объявлений из Санкт-Петербурга (до 20 км) и разброс цен очень большой при этом растояние от центра не сильно сказывается на цене. Но все же цена начинает падать, если квартиры находтся дальше, чем 20 км от центра. Коэффициент корреляции составил -0.32;               
    ***Зависимость цены от количества комнат*** Построили диаграмму рассеяния и диаграмму размаха. По диаграмме размаха видно, как цена растет с увеличением числа комнат и какой большой разброс цен на квартиры в зависимости от количества комнат. Коэффициент корреляции составил 0.41;                
    ***Зависимость цены от этажа (первый, последний, другой)*** Построили диаграмму рассеяния и диаграмму размаха. Цены квартир, расположенных на первом и последнем этажах, практически одинаковы, но такие квартиры дешевле, чем квартиры, раположеные на других этажах.
    ***Заисимость цены от дня, месяца, года подачи объявления*** Построили диаграмму рассеяния и диаграмму размаха. Цены не зависят от дня и месяца подачи объявления. Стоимость квартир в 2016-2018 годах была ниже, чем в остальные годы, но и количество объявлений в эти года больше.
    
    ***Провели анализ предложений квартир в Сантк-Петербурге***
    
    Количество объявлений в Санкт-петербурге составило 12709. Построили график зависимости стоимости квартиры в зависимотсти от удаленности от центра. По графику видно, что центром являются квартиры, которые находтся в радиусе 8 км. Затем идет резкий провал цен, примерно на 950 тыс.руб.
    
    ***Анализ квартир в центре Санкт-Петербурга***
    
    Выделили квартиры, которые находятся в центре Санкт-Петербурга (в радиусе 8 км), таких объявлений оказалось 2053. 
    
    Проанализировали объяления в центре Санкт-Петербурга по следующим параметрам: общая площадь, цена, количество комнат, высота потолков.
    
    ***Площадь***. Средняя площадь квартиры по всем объявлением составляет 61.2 кв.м, медиана же составляет 59.4 кв.м. Гистограмма похожа на Пуассановсое распределение с пиком в районе 45 и плавным дальнешем уменьшением;         
    ***Цена***. Средняя цена квартиры по всем объявлением составляет 7.03 млн. руб, медиана же составляет 6.8 млн. руб. Гистограмма похожа на нормальное распределение с пиком в районе 6 млн:         
    ***Число комнат***. Среднее количество комнат в квартире по всем объявлением соствляет 2.16, медиана же составляет 2. Гистограмма похожа на нормальное распеделение с пиком в районе 2-х комнатных квартир;          
    ***Высота потолков***. Среднее количество комнат в квартире по всем объявлением соствляет 2.76, медиана же составляет 2.75. В центре Санкт-Петербурга очень много квартир с высотой потолков 3 метра, если исключить эти квартиры из гистограммы, то она будет напонимать Гауссовское распределение с центом в районе 2.55 метров и дальнейшим плавным уменьшением.
    
    Выделили и проанализировали факторы, влияющие на стоимость квартиры в центре Санкт-Петербурга
    
    ***Заисимость цены от площади квартиры***. Построили диаграмму рассеяния. По диаграмме хорошо видна зависимость цены от площади квартиры, что также подтвержается посчитанным коэффициентом корреляции, который составил 0.71. Большинство квартир площадью 40-60 кв.м. и ценой 4-8 млн.руб.             
    ***Заисимость цены от удаленности от центра***. Построили диаграмму рассеяния. Видно, что зависмости нет и цена не меняется, так как все квартиры и так сосредоточены в центре. Коэффициент корреляции составил -0.17;             
    ***Зависимость цены от количества комнат*** Построили диаграмму рассеяния и диаграмму размаха. По диаграме видно, как цена растет с увеличением числа комнат и какой большой разброс цен на квартиры в зависимости от количества комнат. Коэффициент корреляции составил 0.45;                
    ***Зависимость цены от этажа (первый, последний, другой)*** Построили диаграмму рассеяния и диаграмму размаха. Цена квартиры на первом этаже значительно дешевле, чем на других этажах.
    ***Заисимость цены от дня, месяца, года подачи объявления*** Построили диаграмму рассеяния и диаграмму размаха. Квартиры, размещенные на продажу в воскресеньк, продаются дороже, чем в другие дни. Зависимости цены от месяца подачи объявления практически нет. Начиная с 2016 года средняя цена квартир упала.
    
    Если сравнивать факторы для центра Санкт-Петербурга и для всего Санкт-Петербурга и области, то можно сделать следующие выводы:
    * Квартиры в центре Санкт-Петербурга в среднем больше по площади (40-60 кв.м), чем квартиры в Санкт-Петербурге и области (30-50 кв.м).Также в центре Санкт-Петербурга в среднем выше цена квартир (4-8 млн.руб.), чем у квартир в Санкт-Петербурге и области (2-5 млн.руб.);
    * Цены квартир в радиусе 8 км при удаленности от центра практически не меняются, но если рассматривать все объявления в Санкт-Петербурге и области, то уменьшение цены при удаленности от центра все же уменьшается;
    * Как и в центре Санкт-Петербурга, так и в целом по Санкт-петербургу и области, цена квартиры увеличивается с увеличением числа комнат;
    * Как и в центре Санкт-Петербурга, так и в целом по Санкт-петербургу и области, цена квартиры, расположенных на первом этаже, ниже, чем на других этажах;
    * День недели подачи объявления не влияет на цену квартир для квартир, расположенных в Санкт-Петербурге и области, однако для квартир, которые расположены в центре Санкт-петербурга лучше объявления подавать в воскресенье, так цена таких квартир выше;
    * Месяц подачи объявления не влияет на цену квартир ни для квартир, расположенных в центре Санкт-Петербурга, ни для квартир, расположенных во всем Санкт-Петербурге и области;
    * В целом с 2016 года цена квартиры упала, как для квартир расположенных в центре Санкт-Петербурга, так и для все квартир в Санкт-Петербурге и области.