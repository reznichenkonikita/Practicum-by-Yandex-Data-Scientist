# Определение возраста покупателей

## Цель и основные шаги работы

**Цель работы**: разработать модель, которая по фотографии предсказывает возраст покупателя. Значение метрики MAE должно быть не более 8.

**Основные шаги работы**:
1. Ознакомиться с данными, содержащимися в файлах и папках;
1. Проверить данные на пропущенные значения, дубликаты, тип данных;
1. Провести исследовательский анализ данных:
    * Построить гистограмму распределния возраста;
    * Сделать выводы по гистограмме.
1. Создать и обучить модель машинного обучения на основе нейронной сети;
1. Провести анализ обученной модели;
1. Написать общий вывод к работе.

## Использумый стек
Python, pandas, matplotlib, numpy, tensorflow

## Вывод
**============================== ИССЛЕДОВАТЕЛЬСКИЙ АНАЛИЗ ДАННЫХ ==============================**  
Анализ DataFrame `labels`:
* DataFrame `labels` содержат информацию о 7591 человеке;
* Пропущенных значений нет;
* Тип данных корректен;
* Средний возраст составляет 31.2 года, медиана 29 лет.

Анализ гистограммы возраста:
* Минимальное значение возраста - 1 год, максимальное 100 лет;  
* 50% данных - фотографии людей от 20 лет до 41 года;  
* Средний возраст 31.2 года;  
* Медиана 29 лет;   
* Сигма 17 лет.

Анализ изображений:
* В одном батче 32 цветных фотографии размером 224x224;
* Некоторые изображения уже повернуты, возможно аугментацию проводить не понадобится.

**================================== АНАЛИЗ ОБУЧЕННОЙ МОДЕЛИ ==================================**  
Полученная модель на тестовой выборке показала значение **MAE = 6.78**, что удовлетврояет условиям ТЗ (на тестовой выборке значение MAE должно быть не более 8).  

Основные моменты при разработке модели:
* Построена модель на основе ResNet с 50 слоями;
* Далее идет слой Flatten для того, чтобы результаты свёрточного слоя можно было передать полносвязному слою. Он делает многомерный тензор одномерным;
* Далее идут слои Dense с постепенно уменьшающимся количеством нейронов, так как на выходе ResNet 1000 нейронов;
* Так как у нас задача регрессии, то последний слой Dense с 1 нейроном;
* Функцию активации выбрали ReLu. ReLU приводит к нулю всё, что меньше 0, и пропускает положительные значения без изменений, а возраст не может быть меньше 0;
* Функцию потерь выбрали Mean Absolute Error, так как в ТЗ написано, что значение метрики  MAE должно быть не более 8;
* Алгоритм обучения выбрали Adam, так как размера шага поиска минимума с помощью этого алгоритма подбирается автоматически. Также этот алгоритм подбирает различные параметры для разных нейронов, что ускоряет обучение модели. Скорость обучения выбрали 0.0001 (`lr=0.0001`).  

Полученная модель сможет предсказывать возраст покупателей с ошибкой +- 7 лет, но не позволит кассирам с увренностью продавать алкоголь.